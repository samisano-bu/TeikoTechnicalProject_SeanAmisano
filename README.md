# Teiko Technical Project: Cell Count Analysis

This project performs a statistical analysis of cell count data to identify significant differences in cell populations between patient cohorts. It includes data loading, database creation, statistical testing, and data visualization.

## Project Structure

```
.
├── analysis.py                  # Main analysis script, generates plots and stats
├── load_data.py                 # Script to load CSV data into a SQLite database
├── cell-count.csv               # Raw input data
├── requirements.txt             # Python dependencies
└── responder_analysis_boxplot.png # Example output plot generated by analysis.py
```

---

## Prerequisites

Before you begin, ensure you have Python 3.8+ installed on your system.

## Setup and Installation

1.  **Clone the repository:**
    ```bash
    git clone <your-repository-url>
    cd <your-repository-directory>
    ```

2.  **Install dependencies:**
    It is highly recommended to use a virtual environment to manage dependencies.

    ```bash
    # Create and activate a virtual environment (optional but recommended)
    python -m venv venv
    source venv/bin/activate  # On Windows, use `venv\Scripts\activate`

    # Install the required packages
    pip install -r requirements.txt
    ```

---

## How to Run the Analysis

The project runs in two simple, sequential steps. You must run them in this order.

1.  **Create the Database:**
    First, run the `load_data.py` script. This will read the `cell-count.csv` file and create a clean SQLite database named `cell_counts.db`.

    ```bash
    python load_data.py
    ```
    *Expected Output:*
    ```
    Successfully loaded data from cell-count.csv
    Database cell_counts.db created.
    Table 'cell_counts' created and populated.
    Database creation process complete.
    ```

2.  **Run the Analysis:**
    Next, run the `analysis.py` script. This script connects to the database created in the previous step, performs two distinct analyses, and saves a boxplot visualization (`responder_analysis_boxplot.png`).

    ```bash
    python analysis.py
    ```
    *Expected Output:*
    The script will print the results of the "Data Subset Analysis (Part 4)" and the "Statistical Analysis (Part 3)", including p-values for each cell population.

---

## Answering Specific Questions

To answer ad-hoc questions about the data, you can use the interactive Python shell. The following example calculates the average number of B cells for male melanoma responders at time=0.

1.  **Run `load_data.py` first** to ensure the database is up-to-date.
2.  **Start the Python interactive shell:** `python`
3.  **Paste the following code:**

    ```python
    import pandas as pd
    import sqlite3

    conn = sqlite3.connect('cell_counts.db')
    query = """
    SELECT b_cell
    FROM cell_counts
    WHERE
        condition = 'melanoma' AND
        sex = 'M' AND
        response = 'yes' AND
        time = 0
    """
    df = pd.read_sql_query(query, conn)
    average_count = df['b_cell'].mean()
    print(f"The average is: {average_count:.2f}")
    conn.close()
    ```
